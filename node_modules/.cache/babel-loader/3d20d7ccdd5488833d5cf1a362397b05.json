{"ast":null,"code":"import _toConsumableArray from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _possibleConstructorReturn from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createClass from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import Web3 from'web3';import Identicon from'identicon.js';import'./App.css';import SocialNetwork from'../abis/SocialNetwork.json';import Navbar from'./Navbar';import Main from'./Main';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);_createClass(App,[{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.loadWeb3();case 2:_context.next=4;return this.loadBlockchainData();case 4:case\"end\":return _context.stop();}}},_callee,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"loadWeb3\",value:function(){var _loadWeb=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!window.ethereum){_context2.next=6;break;}window.web3=new Web3(window.ethereum);_context2.next=4;return window.ethereum.enable();case 4:_context2.next=7;break;case 6:if(window.web3){window.web3=new Web3(window.web3.currentProvider);}else{window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');}case 7:case\"end\":return _context2.stop();}}},_callee2);}));function loadWeb3(){return _loadWeb.apply(this,arguments);}return loadWeb3;}()},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var web3,accounts,networkId,networkData,socialNetwork,postCount,i,post;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:web3=window.web3;// Load account\n_context3.next=3;return web3.eth.getAccounts();case 3:accounts=_context3.sent;this.setState({account:accounts[0]});// Network ID\n_context3.next=7;return web3.eth.net.getId();case 7:networkId=_context3.sent;networkData=SocialNetwork.networks[networkId];if(!networkData){_context3.next=29;break;}socialNetwork=web3.eth.Contract(SocialNetwork.abi,networkData.address);this.setState({socialNetwork:socialNetwork});_context3.next=14;return socialNetwork.methods.postCount().call();case 14:postCount=_context3.sent;this.setState({postCount:postCount});// Load Posts\ni=1;case 17:if(!(i<=postCount)){_context3.next=25;break;}_context3.next=20;return socialNetwork.methods.posts(i).call();case 20:post=_context3.sent;this.setState({posts:[].concat(_toConsumableArray(this.state.posts),[post])});case 22:i++;_context3.next=17;break;case 25:// Sort posts. Show highest tipped posts first\nthis.setState({posts:this.state.posts.sort(function(a,b){return b.tipAmount-a.tipAmount;})});this.setState({loading:false});_context3.next=30;break;case 29:window.alert('SocialNetwork contract not deployed to detected network.');case 30:case\"end\":return _context3.stop();}}},_callee3,this);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()},{key:\"createPost\",value:function createPost(content){var _this2=this;this.setState({loading:true});this.state.socialNetwork.methods.createPost(content).send({from:this.state.account}).once('receipt',function(receipt){_this2.setState({loading:false});});}},{key:\"tipPost\",value:function tipPost(id,tipAmount){var _this3=this;this.setState({loading:true});this.state.socialNetwork.methods.tipPost(id).send({from:this.state.account,value:tipAmount}).once('receipt',function(receipt){_this3.setState({loading:false});});}}]);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.state={account:'',socialNetwork:null,postCount:0,posts:[],loading:true};_this.createPost=_this.createPost.bind(_assertThisInitialized(_this));_this.tipPost=_this.tipPost.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"render\",value:function render(){return React.createElement(\"div\",null,React.createElement(Navbar,{account:this.state.account}),this.state.loading?React.createElement(\"div\",{id:\"loader\",className:\"text-center mt-5\"},React.createElement(\"p\",null,\"Loading...\")):React.createElement(Main,{posts:this.state.posts,createPost:this.createPost,tipPost:this.tipPost}));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/shay.goree/Documents/Blockchain-Projects/Blockchain-Mastery/social-network/src/components/App.js"],"names":["React","Component","Web3","Identicon","SocialNetwork","Navbar","Main","App","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","setState","account","net","getId","networkId","networkData","networks","socialNetwork","Contract","abi","address","methods","postCount","call","i","posts","post","state","sort","a","b","tipAmount","loading","content","createPost","send","from","once","receipt","id","tipPost","value","props","bind"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Identicon from 'identicon.js';\nimport './App.css';\nimport SocialNetwork from '../abis/SocialNetwork.json'\nimport Navbar from './Navbar'\nimport Main from './Main'\n\nclass App extends Component {\n\n  async componentWillMount() {\n    await this.loadWeb3()\n    await this.loadBlockchainData()\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum)\n      await window.ethereum.enable()\n    }\n    else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider)\n    }\n    else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3\n    // Load account\n    const accounts = await web3.eth.getAccounts()\n    this.setState({ account: accounts[0] })\n    // Network ID\n    const networkId = await web3.eth.net.getId()\n    const networkData = SocialNetwork.networks[networkId]\n    if(networkData) {\n      const socialNetwork = web3.eth.Contract(SocialNetwork.abi, networkData.address)\n      this.setState({ socialNetwork })\n      const postCount = await socialNetwork.methods.postCount().call()\n      this.setState({ postCount })\n      // Load Posts\n      for (var i = 1; i <= postCount; i++) {\n        const post = await socialNetwork.methods.posts(i).call()\n        this.setState({\n          posts: [...this.state.posts, post]\n        })\n      }\n      // Sort posts. Show highest tipped posts first\n      this.setState({\n        posts: this.state.posts.sort((a,b) => b.tipAmount - a.tipAmount )\n      })\n      this.setState({ loading: false})\n    } else {\n      window.alert('SocialNetwork contract not deployed to detected network.')\n    }\n  }\n\n  createPost(content) {\n    this.setState({ loading: true })\n    this.state.socialNetwork.methods.createPost(content).send({ from: this.state.account })\n    .once('receipt', (receipt) => {\n      this.setState({ loading: false })\n    })\n  }\n\n  tipPost(id, tipAmount) {\n    this.setState({ loading: true })\n    this.state.socialNetwork.methods.tipPost(id).send({ from: this.state.account, value: tipAmount })\n    .once('receipt', (receipt) => {\n      this.setState({ loading: false })\n    })\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      account: '',\n      socialNetwork: null,\n      postCount: 0,\n      posts: [],\n      loading: true\n    }\n\n    this.createPost = this.createPost.bind(this)\n    this.tipPost = this.tipPost.bind(this)\n  }\n\n  render() {\n    return (\n      <div>\n        <Navbar account={this.state.account} />\n        { this.state.loading\n          ? <div id=\"loader\" className=\"text-center mt-5\"><p>Loading...</p></div>\n          : <Main\n              posts={this.state.posts}\n              createPost={this.createPost}\n              tipPost={this.tipPost}\n            />\n        }\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}